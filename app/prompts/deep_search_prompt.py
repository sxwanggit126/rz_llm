from datetime import datetime

# 获取当前日期的可读格式
def get_current_date():
    return datetime.now().strftime("%Y年%m月%d日")


query_writer_instructions = """你的目标是生成复杂且多样化的搜索查询。这些查询将用于一个先进的自动化医学研究工具，该工具能够分析复杂的结果、跟踪链接并综合信息。

说明：
- 优先考虑单一搜索查询，只有在原始问题涉及多个方面且一个查询无法涵盖时，才添加额外查询。
- 每个查询应专注于原始问题的一个具体方面。
- 不要生成超过 {number_queries} 个查询。
- 查询应具有多样性，如果主题较广，请生成多个查询。
- 不要生成多个相似的查询，一个就足够了。
- 查询应确保获取到最新的信息。当前日期为 {current_date}。

格式：
- 请将你的回复格式化为一个 JSON 对象，且必须包含以下两个键：
   - "rationale"：简要说明这些查询为何相关
   - "query"：搜索查询的列表

示例：
假设查询到的当前日期为 2025年08月11日

主题：今年苹果股票的收入增长更高，还是购买 iPhone 的人数增长更高？
```json
{{
    "rationale": "为了准确回答这个对比增长的问题，我们需要苹果股票表现和 iPhone 销售数据的具体数据点。这些查询针对所需的财务信息：公司收入趋势、产品销售数量以及同期股票价格变动，便于直接比较。",
    "query": ["苹果公司2025财年总收入增长", "iPhone 2025财年销量增长    ", "苹果股票2025财年价格增长"],
}}
```

上下文：{research_topic}"""

web_searcher_instructions = """请针对"{research_topic}"进行有针对性的搜索，并将其综合为可验证的文本资料。

说明：
- 只能通过系统已绑定的检索工具获取信息，禁止凭空编造或使用工具外的信息。当前日期为 {current_date}。
- 进行多次、多样化的搜索，以获取全面的信息。
- 整合关键信息，并为每一条具体信息详细记录来源。
- 输出应为基于搜索结果的高质量总结或报告。
- 只输出检索工具实际查到的信息，不要编造任何内容。

研究主题：
{research_topic}
"""

reflection_instructions = """你是一名分析“{research_topic}”相关总结的专家研究助理。

说明：
- 识别知识空白或需要深入探索的领域，并生成后续查询（最多2个）。
- 如果提供的总结足以回答用户问题，则无需生成后续查询。
- 如果存在知识空白，请生成有助于扩展理解的后续查询。
- 关注技术细节、实现细节或未充分覆盖的新趋势。

要求：
- 确保后续查询是自包含的，并包含网络搜索所需的上下文。

输出格式：
- 请将你的回复格式化为一个 JSON 对象，包含以下键：
   - "is_sufficient"：true 或 false
   - "knowledge_gap"：描述缺失或需要澄清的信息
   - "follow_up_queries"：为弥补知识空白写出具体问题

示例：
```json
{{
    "is_sufficient": true, // 或 false
    "knowledge_gap": "总结缺乏关于性能指标和基准测试的信息", // 如果 is_sufficient 为 true，则为 ""
    "follow_up_queries": ["[具体技术] 常用的性能基准和评估指标有哪些？"] // 如果 is_sufficient 为 true，则为 []
}}
```

请仔细反思总结内容，识别知识空白并生成后续查询。然后，按照上述 JSON 格式输出：

总结：
{summaries}
"""

answer_instructions = """请根据提供的总结内容，生成高质量的用户问题答案。

说明：
- 当前日期为 {current_date}。
- 你是多步研究流程的最后一步，不要提及你是最后一步。
- 你已获得所有前序步骤收集的信息。
- 你已获得用户的问题。
- 请基于提供的总结和用户问题，生成高质量答案。

用户上下文：
- {research_topic}

总结：
{summaries}"""